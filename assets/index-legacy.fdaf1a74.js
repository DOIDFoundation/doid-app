System.register(["./index-legacy.07daaa96.js","./doid-symbol-legacy.3bc3b57a.js","./vendor-legacy.97abf310.js"],(function(t,e){"use strict";var i,s,r,n,a,o,d,c,h,l,p,m,g,u,y,b,w,v,x,f,$,k,S,O,I,T,j,C,D,P;return{setters:[t=>{i=t.l,s=t.k,r=t.h,n=t.T,a=t.c,o=t.s,d=t.b,c=t.g,h=t.m,l=t.r,p=t.e},t=>{m=t.g,g=t.t,u=t.b,y=t.a,b=t.c,w=t.o,v=t.n,x=t.w},t=>{f=t.E,$=t.b,k=t.y,S=t.h,O=t.e,I=t.n,T=t.j,j=t.f,C=t.m,D=t.d,P=t.k}],execute:function(){const e=async(t,e=localStorage,s=!1)=>{const r=async()=>{const r=await i(t,s),n=e.getItem(r);if(n)return JSON.parse(n)};return{get:r,set:async(n,{merge:a=!1}={})=>{const o=await i(t,s);a&&(n=Object.assign(await r()??{},n)),e.setItem(o,JSON.stringify(n))},remove:async()=>e.removeItem(await i(t,s))}},A=()=>(new Date).getTime(),R=async t=>await e(`reg.${t}`,sessionStorage),B="secret",E=async t=>(await R(t)).remove(),M=async t=>{const e=await(async(t,e=B,i=[])=>{const s=await R(t),n=await s.get();if(n)return n;const a=await m(),o={secret:await a.makeCommitment(u(t),await r(),f(e),i),ts:A()};return await s.set(o,{merge:!0}),o})(t),i=await m(),[n,a]=["commit",{}],o=[e.secret];await s(a,i,n,o);const d=i[n](...o),c=await R(t);return new g(d,{errorCodes:"Resolver",seq:{type:"commit",title:"Commit",ts:A(),overrides:a},onSent:()=>c.set({ts:A()},{merge:!0}),onSuccess:()=>c.set({ts:A()},{merge:!0}),onError:()=>c.remove()})};var N=Object.defineProperty,_=Object.getOwnPropertyDescriptor,q=(t,e,i,s)=>{for(var r,n=s>1?void 0:s?_(e,i):e,a=t.length-1;a>=0;a--)(r=t[a])&&(n=(s?r(e,i,n):r(n))||n);return s&&n&&N(e,i,n),n};let Y=class extends(n("")){constructor(){super(...arguments),this.bindBridge=new $(this,a)}get bridge(){return a.bridge}get txScanUri(){const{hash:t}=this.tx;return t?`${this.bridge.network.current.scan}/tx/${t}`:""}render(){return k`<dui-link class="uri mt-4" href="${this.txScanUri}" target="_blank" rel="noopener">View Transaction: ${o(this.tx.hash)}</dui-link>`}};q([S({type:Object})],Y.prototype,"tx",2),Y=q([O("tx-view")],Y);var L=Object.defineProperty,U=Object.getOwnPropertyDescriptor,V=(t,e,i,s)=>{for(var r,n=s>1?void 0:s?U(e,i):e,a=t.length-1;a>=0;a--)(r=t[a])&&(n=(s?r(e,i,n):r(n))||n);return s&&n&&L(e,i,n),n};let H=class extends(n(".tx-state{display:flex;flex-direction:column;align-items:center;flex-grow:1}.tx-state-icon.success{color:green}.tx-state-icon.failed{color:red}.tx-state-icon.warn{color:orange}.tx-state-msg{word-break:break-word;white-space:normal}\n")){constructor(){super(),this.bindBridge=new $(this,a),this.txType=!1,this.onlyAwaitHash=!1,this.opts={}}get bridge(){return a.bridge}get icons(){const[t='<i class="mdi mdi-check-all"></i>',e='<i class="mdi mdi-check"></i>',i='<i class="mdi mdi-close"></i>',s='<i class="mdi mdi-loading"></i>']=this.opts.icons??[];return{success:t,failed:i,wait:s,almostSuccess:e}}get hashOk(){return this.onlyAwaitHash&&this.tx.hash}get state(){let[t,e,i]=["","",""];const{state:s}=this.opts;switch(this.tx.status){case-1:[t,e,i]=[this.icons.wait,s?.wait||"Waiting for confirmation...","wait"];break;case 0:[t,e,i]=[this.icons.failed,this.tx.err?.message??"Something went wrong","failed"];break;case 1:[t,e,i]=[this.icons.success,s?.success||"Success","success"];break;case 2:[t,e]=[this.icons.wait,"Confirm the transaction."];break;case 4:[t,e,i]=[this.icons.almostSuccess,this.tx.err?.message||"Almost Success","warn"]}return this.hashOk&&([t,e,i]=[this.icons.success,s?.success||"Success","success"]),{icon:t,txt:e,css:i}}get txScanUri(){const{hash:t}=this.tx;return t?`${this.bridge.network.current.scan}/tx/${t}`:""}render(){return k`<div class="tx-state m-4"><div class="tx-state-icon my-3 text-3xl mx-auto ${this.state.css}">${I(this.tx.pending&&!this.hashOk,(()=>k`<slot name="pending"><i class="mdi mdi-loading"></i></slot>`),(()=>k`<span>${T(this.state.icon)}</span>`))}</div><div class="tx-state-msg my-4"><slot>${this.state.txt}</slot></div><div class="flex gap-4">${I(this.tx.hash,(()=>k`${I(this.tx.success||this.tx.almostSuccess,(()=>k`<slot name="view"><tx-view .tx="${this.tx}"></tx-view></slot>`),(()=>k`<tx-view .tx="${this.tx}"></tx-view>`))}`))}</div></div>`}};V([S({type:Object})],H.prototype,"tx",2),V([S({type:Boolean})],H.prototype,"txType",2),V([S({type:Boolean})],H.prototype,"onlyAwaitHash",2),V([S({type:Object})],H.prototype,"opts",2),H=V([O("tx-state")],H);var F=Object.defineProperty,G=Object.getOwnPropertyDescriptor,J=(t,e,i,s)=>{for(var r,n=s>1?void 0:s?G(e,i):e,a=t.length-1;a>=0;a--)(r=t[a])&&(n=(s?r(e,i,n):r(n))||n);return s&&n&&F(e,i,n),n};let W=class extends(n("")){constructor(){super(...arguments),this.bindBridge=new $(this,a),this.sm=!1,this.tx=null,this.success=!1,this.dialog=!1,this.claim=async()=>{try{this.tx=await(async t=>{const e=await d("Locker",{account:await r()}),[i,n,a]=["claimDoid",{},[+t]];await s(n,e,i,a);const o=e[i](...a);return new g(o,{errorCodes:"Locker",seq:{type:"claim-name",title:"Claim Name",ts:(new Date).getTime(),overrides:n}})})(+this.passId),this.success=await this.tx.wait()}catch(t){if(4001===t.code)return this.close()}}}get name(){return this.nameInfo?.name}get passId(){return this.nameInfo?.id||0}get txPending(){return this.tx&&!this.tx?.ignored}close(t=!1){this.dialog=!1,this.tx=void 0,t&&this.emit("success"),this.emit("show",!1)}open(){this.dialog=!0,this.emit("show",!0)}render(){return k`<dui-button ?disabled="${this.dialog}" ?pending="${this.dialog}" class="success" @click="${this.open}" ?sm="${this.sm}"><slot>Claim</slot></dui-button>${I(this.dialog,(()=>k`<dui-dialog @close="${()=>this.close()}"><div slot="header">Claim DOID name</div><div class="min-h-10">${I(!this.tx?.success,(()=>k`<div class="text-center">You are claiming for:<p class="text-black my-4 text-lg"><b class="text-blue-600">${this.name}</b>.doid</p><p>${k`(Note: This pass <b class="text-base text-orange-500">#${this.passId}</b> will be burned after claiming.)`}</p></div>`))} ${I(this.txPending,(()=>k`<tx-state .tx="${this.tx}" .opts="${{state:{success:`Success. You are the registrant of ${this.name} now`}}}"><dui-button slot="view" @click="${()=>this.close(!0)}">Close</dui-button></tx-state>`),(()=>k`<p class="mt-8 text-center"><dui-button class="success" @click="${this.claim}">Continue</dui-button></p>`))}</div></dui-dialog>`))}`}};J([S({type:Object})],W.prototype,"nameInfo",2),J([S({type:Boolean})],W.prototype,"sm",2),J([j()],W.prototype,"tx",2),J([j()],W.prototype,"success",2),J([j()],W.prototype,"dialog",2),W=J([O("doid-claim-name")],W);var z=Object.defineProperty,K=Object.getOwnPropertyDescriptor,Q=(t,e,i,s)=>{for(var r,n=s>1?void 0:s?K(e,i):e,a=t.length-1;a>=0;a--)(r=t[a])&&(n=(s?r(e,i,n):r(n))||n);return s&&n&&z(e,i,n),n};let X=class extends(n(".per{background:linear-gradient(90deg,rgba(96,184,100,1) 0%,rgba(76,175,80,1) 100%)}\n")){constructor(){super(...arguments),this.percent=0,this.randomTo=0,this.precision=2,this.label=!1,this.state=!1,this.pending=!1,this.randomProgress=this.randomTo,this.randomTimer=null}get progress(){return Math.min(this.percent,100)}get per(){return(this.randomTo?Math.max(this.progress,this.randomProgress):this.progress).toFixed(this.precision)}shouldUpdate(t){return t.has("randomTo")&&(this.randomTo?(this.randomProgress=this.percent,this.randomTimer=setInterval((()=>{this.randomProgress+=Math.floor(1.1*Math.random()+.1),this.randomProgress>=this.randomTo&&clearInterval(this.randomTimer)}),200)):clearInterval(this.randomTimer)),!0}render(){return k`<div class="relative flex grow w-full items-center"><div class="bar bg-gray-300 relative block w-full h-1.5 overflow-hidden rounded-full"><p class="per pr-1 absolute top-0 h-full rounded-full transition-all bg-green-600" style="${C({width:`${this.per}%`})}"></p></div></div>`}};Q([S({type:Number})],X.prototype,"percent",2),Q([S({type:Number})],X.prototype,"randomTo",2),Q([S({type:Number})],X.prototype,"precision",2),Q([S({type:Boolean})],X.prototype,"label",2),Q([S({type:Boolean})],X.prototype,"state",2),Q([j()],X.prototype,"pending",2),Q([j()],X.prototype,"randomProgress",2),Q([j()],X.prototype,"randomTimer",2),X=Q([O("progress-bar")],X);var Z=Object.defineProperty,tt=Object.getOwnPropertyDescriptor,et=(t,e,i,s)=>{for(var r,n=s>1?void 0:s?tt(e,i):e,a=t.length-1;a>=0;a--)(r=t[a])&&(n=(s?r(e,i,n):r(n))||n);return s&&n&&Z(e,i,n),n};let it=class extends(n('ol{margin-top:1rem;margin-bottom:1rem;display:grid;grid-gap:1rem;gap:1rem}@media (min-width: 768px){ol{grid-template-columns:repeat(3,minmax(0,1fr))}}ol li{position:relative;display:inline-flex;flex-direction:column;gap:.5rem;border-radius:.375rem;border-width:1px;--tw-bg-opacity: 1;background-color:rgba(243,244,246,var(--tw-bg-opacity));padding:1.25rem 1rem 1rem 3.5rem}ol li:before{position:absolute;left:.75rem;top:.75rem;display:flex;height:2rem;width:2rem;align-items:center;justify-content:center;border-radius:9999px;border-width:1px;--tw-bg-opacity: 1;background-color:rgba(255,255,255,var(--tw-bg-opacity));font-weight:700}ol li.active,ol li.done{border-style:dashed;--tw-border-opacity: 1;border-color:rgba(156,163,175,var(--tw-border-opacity));--tw-bg-opacity: 1;background-color:rgba(226,232,240,var(--tw-bg-opacity))}ol li.active:before,ol li.done:before{--tw-border-opacity: 1;border-color:rgba(148,163,184,var(--tw-border-opacity));--tw-bg-opacity: 1;background-color:rgba(248,250,252,var(--tw-bg-opacity))}ol li.done{border-color:transparent}ol li.done:before{--tw-border-opacity: 1;border-color:rgba(22,163,74,var(--tw-border-opacity));--tw-bg-opacity: 1;background-color:rgba(240,253,244,var(--tw-bg-opacity));--tw-text-opacity: 1;color:rgba(22,163,74,var(--tw-text-opacity))}ol li>b{display:block}ol li>p{line-height:1.375}ol li:nth-child(1):before{content:"1"}ol li:nth-child(2):before{content:"2"}ol li:nth-child(3):before{content:"3"}\n')){constructor(){super(...arguments),this.name="",this.done=!1,this.pending=!1,this.err="",this.ts=0,this.step=1,this.tx=null,this.commitment={},this.cd=0,this.timer=null,this.goStep2=()=>{this.step=2,this.cd=60,this.timer=setInterval((()=>{--this.cd<=0&&this.goStep3()}),1e3)},this.goStep3=()=>{this.step=3,clearInterval(this.timer)},this.getCommitment=async()=>{this.commitment=await(async t=>{const e=await R(t),i=await e.get();if(!(i&&A()-i.ts>=864e5))return i;e.remove()})(this.name)||{}},this.get=async()=>{await this.getCommitment();const{secret:t,ts:e}=this.commitment;e&&A()-e>6e4?this.goStep3():t&&this.goStep2(),this.ts++},this.commit=async()=>{this.pending=!0,this.err="";try{this.tx=await M(this.name),await this.tx.wait(),this.goStep2()}catch(t){4001!==t.code&&/( IC)/.test(t.message)&&(this.err="This name is already committed by someone else, please try again later"),E(this.name),this.tx=null}finally{this.pending=!1}},this.register=async()=>{if(this.done)return c(`/name/${this.name}/details`);if(3!==this.step)return this.commit();this.pending=!0,this.err="";try{this.tx=await(async(t,e=B,i=[])=>{const n=await m(),[a,o]=["register",{}],d=[u(t),await r(),f(e),i];await s(o,n,a,d);const c=n[a](...d);return new g(c,{errorCodes:"Resolver",seq:{type:"register",title:"Register",ts:A(),overrides:o}})})(this.name),this.done=await this.tx.wait(),E(this.name)}catch(t){4001!==t.code&&(this.err=t.message),this.tx=null}finally{this.pending=!1}},this.go2success=()=>{c(this.detailsLink)}}get btn(){return{disabled:this.err||this.pending||2===this.step,title:this.done?"Manage name":this.step>1?"Register":"Request to Register"}}get txSuccess(){return this.tx&&!this.tx.ignored}get lockedByMe(){const{locked:t,itsme:e}=this.nameInfo;return t&&e}get detailsLink(){return`/name/${this.name}/details`}get txPending(){return this.tx&&!this.tx?.ignored}get percent(){if(this.done)return 100;if(1===this.step){if(this.pending&&!this.tx)return 2;if(this.tx)return 5}if(2===this.step)return 35;if(3===this.step){if(this.pending&&!this.tx)return 70;if(this.tx)return 75}return 3===this.step?68:0}get randomTo(){return 1===this.step&&this.tx?35:2===this.step?68:3===this.step&&this.tx?99:0}connectedCallback(){super.connectedCallback(),this.get()}render(){return this.nameInfo.available?this.lockedByMe?k`<div class="px-3"><h3 class="text-base mb-4">${`This DOID name is already locked by pass #${this.nameInfo.locked}`}</h3><doid-claim-name @success="${this.go2success}" .nameInfo="${this.nameInfo}">Claim this name</doid-claim-name></div>`:k`<div class="px-3"><h3 class="text-base">${this.done?"You’ve completed all the steps, manage your name now!":"Registering a name requires you to complete 3 steps"}</h3><ol><li class="${D({done:this.done||this.step>1,active:this.step>=1})}"><b>Request to register</b><p>Your wallet will open and you will be asked to confirm the first of two transactions required for registration. If the second transaction is not processed within 7 days of the first, you will need to start again from step 1.</p></li><li class="${D({done:this.done||this.step>2,active:this.step>=2})}"><b>Wait for ${this.cd?`${this.cd} seconds`:"1 minute"}</b><p>The waiting period is required to ensure another person hasn’t tried to register the same name and protect you after your request.</p></li><li class="${D({done:this.done,active:this.step>=3})}"><b>Complete Registration</b><p>Click ‘register’ and your wallet will re-open. Only after the 2nd transaction is confirmed you'll know if you got the name.</p></li></ol><progress-bar .percent="${this.percent}" .randomTo="${this.randomTo}" class="my-4"></progress-bar><div class="my-4 flex justify-center items-center h-9"><dui-button @click="${this.register}" ?disabled="${this.btn.disabled}" class="${D({secondary:this.done})}" ?pending="${this.pending}">${this.btn.title}${I(this.cd,(()=>k`<span class="ml-2">(${this.cd})</span>`),(()=>k`<i class="mdi ml-2 ${D(this.$c([this.pending?"mdi-loading":"mdi-chevron-right"]))}"></i>`))}</dui-button></div><div class="text-center">${I(this.done,(()=>k`<p class="text-green-600">Success!</p>`))} ${I(this.err,(()=>k`<p class="text-red-500">${this.err}</p>`))}</div></div>`:k`${I(this.nameInfo.itsme,(()=>k`<div class="px-3"><dui-button class="secondary" href="${this.detailsLink}">Manage your name <i class="mdi mdi-chevron-right"></i></dui-button></div>`),(()=>k`<div class="px-3">This DOID name is already taken.<dui-link class="mx-1" href="${this.detailsLink}">See Details</dui-link></div>`))}`}};et([S()],it.prototype,"name",2),et([S({type:Object})],it.prototype,"nameInfo",2),et([j()],it.prototype,"done",2),et([j()],it.prototype,"pending",2),et([j()],it.prototype,"err",2),et([j()],it.prototype,"ts",2),et([j()],it.prototype,"step",2),et([j()],it.prototype,"tx",2),et([j()],it.prototype,"commitment",2),et([j()],it.prototype,"cd",2),et([j()],it.prototype,"timer",2),it=et([O("view-name-register")],it);var st=Object.defineProperty,rt=Object.getOwnPropertyDescriptor,nt=(t,e,i,s)=>{for(var r,n=s>1?void 0:s?rt(e,i):e,a=t.length-1;a>=0;a--)(r=t[a])&&(n=(s?r(e,i,n):r(n))||n);return s&&n&&st(e,i,n),n};let at=class extends(n(".card{position:relative;display:flex;flex-direction:column;gap:1rem;--tw-bg-opacity: 1;background-color:rgba(243,244,246,var(--tw-bg-opacity));padding:1.25rem 1rem 1rem 3.5rem}.card:before{position:absolute;left:.75rem;top:.75rem;display:flex;height:2rem;width:2rem;align-items:center;justify-content:center;border-radius:9999px;border-width:1px;--tw-bg-opacity: 1;background-color:rgba(255,255,255,var(--tw-bg-opacity));font-weight:700;content:attr(idx)}.card.active{--tw-bg-opacity: 1;background-color:rgba(226,232,240,var(--tw-bg-opacity))}.card.active:before{--tw-border-opacity: 1;border-color:rgba(148,163,184,var(--tw-border-opacity))}\n")){constructor(){super(...arguments),this.class="",this.index=1}connectedCallback(){super.connectedCallback()}disconnectedCallback(){super.disconnectedCallback()}render(){return k`<div class="card h-full ${D(this.$c([this.class]))}" idx="${this.index}"><slot name="title" part="step-title"></slot><slot name="description" part="step-desc"></slot></div>`}};nt([S({type:String})],at.prototype,"class",2),nt([S({type:String})],at.prototype,"index",2),at=nt([O("dui-card")],at);var ot=Object.defineProperty,dt=Object.getOwnPropertyDescriptor,ct=(t,e,i,s)=>{for(var r,n=s>1?void 0:s?dt(e,i):e,a=t.length-1;a>=0;a--)(r=t[a])&&(n=(s?r(e,i,n):r(n))||n);return s&&n&&ot(e,i,n),n};let ht=class extends(n("")){constructor(){super(...arguments),this.bindBridge=new $(this,a),this.owner=!1,this.coin={},this.name="",this.currentAddr="",this.step=1,this.signatureInfo={},this.pending=!1,this.err="",this.stored={},this.tx=null,this.success=!1,this.getStorage=async()=>await e(`sign.${this.name}`,sessionStorage,!0),this.getStoredInfo=async()=>{const t=await this.getStorage(),e=await t.get();this.stored=e,this.stored?.signature&&(this.step=2)},this.getSignatureMessage=async()=>{this.signatureInfo=await y(this.name,this.account,this.coin.coinType);const t=await e(`sign.${this.name}`,sessionStorage,!0),i={...this.stored,...this.signatureInfo};t.set(i),this.stored=i},this.next=async()=>{if(this.name&&this.ownerAddress&&this.coin.coinType&&this.account&&(!this.owner||!this.currentAddr)){this.pending=!0,this.err="";try{await this.getSignatureMessage(),this.step=2}catch(t){if(4001===t.code)return;this.err=t.message}finally{this.pending=!1}}},this.setAddr=async()=>{if(this.pending)return;this.pending=!0,this.err="",this.success=!1;const{name:t,coinType:e,dest:i,timestamp:s,nonce:r,signature:n}=this.stored,a=await this.getStorage();try{this.tx=await b(t,e,i,+s,r,n);const o=await this.tx.wait();a.remove(),await h(1e3),this.success=o,this.emit("success")}catch(S){this.err=S,console.error(S)}finally{this.pending=!1,a.remove()}},this.disconnectedCallback=()=>{super.disconnectedCallback()}}get ownerAddress(){return this.stored.source}get dest(){return this.stored.dest}get msg(){return this.stored.msg}get account(){return a.bridge.account}get isStep1(){return 1===this.step}get signature(){return this.stored.signature||this.signatureInfo?.signature}get txPending(){return this.tx&&!this.tx?.ignored}get btnSignDisabled(){return!!this.currentAddr&&(this.pending||this.err||this.owner||this.txPending)}get btnSetDisabled(){return this.pending||this.err||!this.signature||!this.owner||this.txPending}async connectedCallback(){super.connectedCallback(),await this.getStoredInfo()}render(){return k`<div class="set-record border border-gray-300 border-dashed pt-2 pb-5 mt-2"><div class="dui-container"><div class="border-b-2 flex my-4 px-3 pr-4 justify-between"><div>You are setting <b>${this.coin.name}</b> address to ${I(this.isStep1,(()=>k`${I(this.owner,(()=>k``),(()=>k`${this.account}`))}`),(()=>k`${this.dest||this.account}`))}</div></div><div>${I(this.pending&&!this.ownerAddress,(()=>k``),(()=>k`<div class="px-3"><h3 class="text-base">Setting an address requires you to complete 2 steps</h3><div class="grid md_grid-cols-2 gap-4 my-4"><dui-card index="1" class="rounded-md ${D({active:this.step>=1})}"><div slot="title"><b>SIGN A MESSAGE TO VERIFY YOUR ADDRESS</b></div><div slot="description" class="flex flex-col gap-2"><p>Your wallet will open and following message will be shown:</p><div>${I(this.msg,(()=>k`<span class="text-gray-500">Message:</span><p class="break-words">${this.msg}</p>`),(()=>k``))}</div></div></dui-card><dui-card index="2" class="rounded-md ${D({active:this.step>=2})}"><div slot="title"><b>Complete Setting</b></div><div slot="description" class="flex flex-col gap-2"><p class="break-words">You need to change your wallet back to ${I(!this.owner&&!this.isStep1,(()=>k`${this.ownerAddress}`),(()=>k`the address`))} that owns <b>${this.name}</b></p><p>Click 'set' and your wallet will re-open. Only after the transaction is confirmed your address will be set.</p></div></dui-card></div><div class="mt-4 text-center">${I(this.isStep1,(()=>k`<dui-button sm @click="${this.next}" ?disabled="${this.btnSignDisabled}" ?pending="${this.pending}">Sign message<i class="mdi ml-2 ${D(this.$c([this.pending?"mdi-loading":"mdi-chevron-right"]))}"></i></dui-button>`),(()=>k`<dui-button sm @click="${this.setAddr}" ?disabled="${this.btnSetDisabled}" ?pending="${this.pending}">Set<i class="mdi ml-2 ${D(this.$c([this.pending?"mdi-loading":""]))}"></i></dui-button>`))}</div></div>`))}</div></div></div>`}};ct([S({type:Boolean})],ht.prototype,"owner",2),ct([S({type:Object})],ht.prototype,"coin",2),ct([S({type:String})],ht.prototype,"name",2),ct([S({type:String})],ht.prototype,"currentAddr",2),ct([j()],ht.prototype,"step",2),ct([j()],ht.prototype,"signatureInfo",2),ct([j()],ht.prototype,"pending",2),ct([j()],ht.prototype,"err",2),ct([j()],ht.prototype,"stored",2),ct([j()],ht.prototype,"tx",2),ct([j()],ht.prototype,"success",2),ht=ct([O("doid-set-record-wallet")],ht);var lt=Object.defineProperty,pt=Object.getOwnPropertyDescriptor,mt=(t,e,i,s)=>{for(var r,n=s>1?void 0:s?pt(e,i):e,a=t.length-1;a>=0;a--)(r=t[a])&&(n=(s?r(e,i,n):r(n))||n);return s&&n&&lt(e,i,n),n};let gt=class extends(n(".addr_name{min-width:100px;max-width:140px}.edit{margin-top:0;margin-bottom:0}.edit .addr_edit{width:14rem}@media (min-width: 1024px){.edit .addr_edit{width:24rem}}@media (max-width: 1024px){.addr_name{min-width:50px;max-width:60px}}\n")){constructor(){super(...arguments),this.bindBridge=new $(this,a),this.item={},this.owner=!1,this.name="",this.tip={addr:""},this.err={addr:"",tx:""},this.pending={addr:!1,tx:!1},this.addr="",this.addrValid=!1,this.mode="",this.stored={},this.setAddr=async()=>{this.mode="edit",(await e(`sign.${this.name}`,sessionStorage,!0)).set({...this.coinType,source:this.address||this.account})},this.onSuccess=()=>{this.mode="",this.checkEditInfo(),this.emit("success")},this.disconnectedCallback=()=>{super.disconnectedCallback()}}get account(){return a.bridge.account}get isOwner(){return 1==this.owner}get isEditing(){return"edit"===this.mode}get isStored(){return this.stored?.source&&this.stored?.coinType==this.coinType.coinType}get editDisabled(){return 1==this.isEditing}get address(){return this.item.address}get coinType(){return{name:this.item.name,coinType:this.item.coinType}}async checkEditInfo(){const t=await e(`sign.${this.name}`,sessionStorage,!0),i=await t.get();this.stored=i}async connectedCallback(){super.connectedCallback(),this.addr=this.address,await this.checkEditInfo()}render(){return k`<div class="w-full flex justify-start items-center my-3 ${this.mode}"><div class="addr_name text-gray-400">${this.coinType.name}</div><div class="grow inline-flex items-center">${I(this.address,(()=>k`<div class="mr-1">${this.address}</div><dui-copy .value="${this.address}" sm icon><span slot="copied" class="text-green-500"><i class="mdi mdi-check-circle-outline"></i> </span><span slot="copy"><i class="mdi mdi-content-copy"></i></span></dui-copy>`),(()=>k`${I(this.isOwner,(()=>k`<span class="text-gray-400">No set</span>`),(()=>k``))}`))} ${I(this.isOwner&&!this.isEditing,(()=>k`<dui-button sm icon class="ml-1" .disabled="${this.editDisabled}"><i class="mdi mdi-pencil-outline" @click="${this.setAddr}"></i></dui-button>`),(()=>k``))}</div></div>${I(this.isEditing||this.isStored,(()=>k`<doid-set-record-wallet .name="${this.name}" .coin="${this.coinType}" .owner="${this.isOwner}" .currentAddr="${this.address}" @success="${this.onSuccess}"></doid-set-record-wallet>`),(()=>k``))}`}};mt([S({type:Object})],gt.prototype,"item",2),mt([S({type:Boolean})],gt.prototype,"owner",2),mt([S({type:String})],gt.prototype,"name",2),mt([j()],gt.prototype,"tip",2),mt([j()],gt.prototype,"err",2),mt([j()],gt.prototype,"pending",2),mt([j()],gt.prototype,"addr",2),mt([j()],gt.prototype,"addrValid",2),mt([j()],gt.prototype,"mode",2),mt([j()],gt.prototype,"stored",2),gt=mt([O("doid-addr-item")],gt);var ut=Object.defineProperty,yt=Object.getOwnPropertyDescriptor,bt=(t,e,i,s)=>{for(var r,n=s>1?void 0:s?yt(e,i):e,a=t.length-1;a>=0;a--)(r=t[a])&&(n=(s?r(e,i,n):r(n))||n);return s&&n&&ut(e,i,n),n};let wt=class extends(n(".item_key{width:13rem;font-weight:500;min-width:140px;max-width:180px}\n")){constructor(){super(...arguments),this.bindBridge=new $(this,a),this.info={},this.name="",this.pending=!1,this.ts=0,this.records=[],this.get=async()=>{this.ts++},this.fetchRecords=async()=>{this.records=await w(this.info?.name)},this.onSuccess=()=>{this.fetchRecords()}}get account(){return a.bridge.account}get empty(){return!this.records?.length}connectedCallback(){this.get(),super.connectedCallback(),this.fetchRecords()}render(){return new URL(location.href).searchParams.get("sign")?k``:k`<div class="px-3 py-4"><div class="flex justify-start items-center mb-3"><div class="item_key">PARENT</div><div><a href="/name/doid/details" class="text-blue-500">doid</a></div></div><hr class="mb-3 border-t border-dashed border-gray-300"><div class="flex flex-col lg_flex-row justify-start items-start mb-3"><div class="item_key">ADDRESS</div><div class="flex flex-col">${I(this.empty,(()=>k``),(()=>k`${P(this.records,(t=>k`<doid-addr-item key="${t.coinType}" .item="${t}" .name="${this.name}" .owner="${this.info.itsme}" @success="${this.onSuccess}"></doid-addr-item>`))}`))}</div></div></div>`}};bt([S({type:v})],wt.prototype,"info",2),bt([S()],wt.prototype,"name",2),bt([j()],wt.prototype,"pending",2),bt([j()],wt.prototype,"ts",2),bt([j()],wt.prototype,"records",2),wt=bt([O("view-name-details")],wt);var vt=Object.defineProperty,xt=Object.getOwnPropertyDescriptor,ft=(t,e,i,s)=>{for(var r,n=s>1?void 0:s?xt(e,i):e,a=t.length-1;a>=0;a--)(r=t[a])&&(n=(s?r(e,i,n):r(n))||n);return s&&n&&vt(e,i,n),n};let $t=t("ViewName",class extends(n(":host::part(dui-nav){display:flex;margin-bottom:-2px}\n")){constructor(){super(...arguments),this.name="",this.action="",this.pending=!1,this.disconnected=!1,this.nameInfo=null,this.goto=()=>{l(`/name/${x(this.name)}/${this.action}`)},this.check=async(t,e=!1)=>{if(this.pending)return;if(await this.isDisconnected(e))return;this.pending=!0;const i=x(this.name);if(this.name!==i)this.name=i;else try{if(await this.isDisconnected(!0))return;if(this.nameInfo=await v(this.name),await this.isDisconnected(!0))return;this.action||(this.action=this.nameInfo.available?"register":"details")}catch(s){this.nameInfo=null}this.goto(),this.pending=!1}}get inReg(){return this.nameInfo&&!this.pending&&"register"===this.action}get inDetails(){return this.nameInfo&&!this.pending&&"details"===this.action}get empty(){return!this.name}connectedCallback(){super.connectedCallback(),this.check(null,!0),p.on("router-change",this.check)}disconnectedCallback(){super.disconnectedCallback(),p.off("router-change",this.check)}render(){return k`<div class="view-name"><div class="dui-container"><dui-ns-search .text="${this.name}" @search="${t=>c(`/search/${t.detail}`)}" placeholder="Search names"><span slot="label"></span> <span slot="msgd"></span></dui-ns-search>${I(this.name,(()=>k`<div class="border-b-2 flex my-4 px-3 pr-4 justify-between items-end"><div><b class="text-lg">${this.name}</b> ${I("doid"===this.name,(()=>k`<em>(Registrant)</em>`))}</div><div><dui-nav slot="center" part="dui-nav"><dui-link href="${`/name/${this.name}/register`}" alias="${`/name/${this.name}`}" exact nav>Register</dui-link><dui-link href="${`/name/${this.name}/details`}" exact nav>Details</dui-link></dui-nav></div></div>`))} ${I(this.pending,(()=>k`<i class="mdi mdi-loading"></i> Loading...`))} ${I(this.inReg,(()=>k`<view-name-register .name="${this.name}" .nameInfo="${this.nameInfo}"></view-name-register>`))} ${I(this.inDetails,(()=>k`<view-name-details .name="${this.name}" .info="${this.nameInfo}"></view-name-details>`))}</div></div>`}});ft([S()],$t.prototype,"name",2),ft([S()],$t.prototype,"action",2),ft([j()],$t.prototype,"pending",2),ft([j()],$t.prototype,"disconnected",2),ft([j()],$t.prototype,"nameInfo",2),t("ViewName",$t=ft([O("view-name")],$t))}}}));
